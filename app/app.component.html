
<div class="workflow-graph-container">
  <ng-container *ngFor="let workStage of workStages">
    <div class="workstage-container">
      <div class="workstage-title-box">
        <div> 
          <div>
            <img src="https://icons.iconarchive.com/icons/iconsmind/outline/256/Server-icon.png" style="width:2em;height:1.5em;" />
          </div>
          <span>{{workStage.name}}</span>
        </div>
        <div><img /></div> 
      </div>
      <div class="workstage-progress-container">
        <div class="workstage-progress-timeline">
          <ng-container *ngFor="let workTimeLine of workTimeLineContents; let i = index" >
            <!-- draw message box -->
            <div *ngIf="drawMessageBox(workTimeLine.type,workTimeLine.id,workStage.id);else draw_line">
              <div class="workstage-message-box-container">
                <div class="workstage-message-box">
                  <!-- <span>o</span> <br/> -->
                  <span>#</span>  <br/>
                  <span>{{workTimeLine.text}}</span>
                </div>
              </div>
            </div>
            <!-- else draw line -->
            <ng-template #draw_line>
                <div *ngIf="drawLine(workTimeLine.type,workTimeLine.start,workStage.id);else blank_content">
                <div class='svg-container'>
                  <div>
                    <span class="line-text"[style.width.em]="workTimeLine.emVal" [style.marginLeft.em]="workTimeLine.emVal/1.5" >
                    <div class="line-count">{{workTimeLine.stepCount}}</div>
                    {{workTimeLine.text}}</span>
                  </div>
                  <span>
                    <svg height="1" attr.width="{{workTimeLine.emVal}}em" style="position:absolute">
                    <line x1="0" y1="0" [attr.x2]="workTimeLine.width" y2="0" style="stroke:#001D6D;stroke-width:2" />
                    Sorry, your browser does not support inline SVG.
                  </svg>
                  </span>
                  <span *ngIf="workTimeLine.direction == 'left'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="11" height="14" viewBox="0 0 16 14" fill="none" 
                    style="position:absolute;top: 1.1em"
                    [style.left.em]="workTimeLine.emVal + 5.75">
                      <path d="M4.00128 0.5C5.76885 0.5 7.28467 1.2946 8.95845 2.58364C9.75536 3.19737 10.572 3.91006 11.4629 4.68761C11.5081 4.72705 11.5534 4.76666 11.599 4.80644C12.4099 5.51395 13.2787 6.26845 14.232 7.03018C13.7246 7.49989 13.2558 7.93592 12.8206 8.34073C10.6817 10.3302 9.35362 11.5655 8.23023 12.338C7.53958 12.8129 6.94651 13.097 6.30837 13.2668C5.66424 13.4382 4.9491 13.5 4.00128 13.5C3.1986 13.5 2.69666 13.3207 2.36711 13.0586C2.03737 12.7963 1.81446 12.3989 1.67413 11.83C1.53244 11.2556 1.48551 10.5495 1.47779 9.72006C1.47353 9.26254 1.48065 8.80119 1.48814 8.31596C1.49458 7.89916 1.50128 7.46474 1.50128 7C1.50128 6.53556 1.49459 6.10133 1.48817 5.6847C1.48068 5.19921 1.47357 4.73761 1.47784 4.27995C1.48559 3.4505 1.53256 2.74444 1.67427 2.17001C1.81462 1.60113 2.03754 1.20368 2.36728 0.941397C2.69681 0.679268 3.19871 0.5 4.00128 0.5Z" stroke="#232361"/>
                      <path d="M11 7C8.75397 5.5 7.43928 4 5.50969 4C3.76283 4 4.01234 5.34315 4.01234 7C4.01234 8.65685 3.76265 10 5.50969 10C7.43928 10 7.75573 9.57143 11 7Z" fill="#001D6D"/>
                    </svg>
                    <span class="right-dot"></span>
                  </span>
                  <span *ngIf="workTimeLine.direction == 'right'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="11" height="14" viewBox="0 0 15 14" fill="none"
                    style="position:absolute;top: 1.1em;right:5.75em">
                      <path d="M10.9987 0.5C9.23115 0.5 7.71533 1.2946 6.04155 2.58364C5.24464 3.19737 4.42804 3.91006 3.53713 4.68761C3.49194 4.72705 3.44656 4.76666 3.40097 4.80644C2.5901 5.51395 1.72133 6.26845 0.767959 7.03018C1.27542 7.49989 1.7442 7.93592 2.17941 8.34073C4.3183 10.3302 5.64638 11.5655 6.76977 12.338C7.46042 12.8129 8.05349 13.097 8.69163 13.2668C9.33576 13.4382 10.0509 13.5 10.9987 13.5C11.8014 13.5 12.3033 13.3207 12.6329 13.0586C12.9626 12.7963 13.1855 12.3989 13.3259 11.83C13.4676 11.2556 13.5145 10.5495 13.5222 9.72006C13.5265 9.26254 13.5193 8.80119 13.5119 8.31596C13.5054 7.89916 13.4987 7.46474 13.4987 7C13.4987 6.53556 13.5054 6.10133 13.5118 5.6847C13.5193 5.19921 13.5264 4.73761 13.5222 4.27995C13.5144 3.4505 13.4674 2.74444 13.3257 2.17001C13.1854 1.60113 12.9625 1.20368 12.6327 0.941397C12.3032 0.679268 11.8013 0.5 10.9987 0.5Z" stroke="#232361"/>
                      <path d="M4 7C6.24603 5.5 7.56072 4 9.49031 4C11.2372 4 10.9877 5.34315 10.9877 7C10.9877 8.65685 11.2374 10 9.49031 10C7.56072 10 7.24427 9.57143 4 7Z" fill="#001D6D"/>
                    </svg>
                    <span class="left-dot" [style.left.em]="workTimeLine.emVal + 5.83"></span>
                  </span>
                </div>
              </div>
            </ng-template>
            <!-- else draw empty box -->
            <ng-template #blank_content>
              <div class="workstage-message-blank"></div>
            </ng-template>
          </ng-container> 
        </div>
      </div>
    </div>
  </ng-container> 
</div>
